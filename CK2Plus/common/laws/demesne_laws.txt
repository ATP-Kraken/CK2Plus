# Demesne type (de facto) laws (set for the PRIMARY title in a demesne but affects the whole demesne)

law_groups = {
	centralization = {
		law_type = realm
	}
	tribal_organization = {
		law_type = realm
		allowed_for_councillors = yes
	}
	vice_royalty = {
		law_type = realm
	}
	administration = {
		law_type = realm
	}
	feudal_contract = {
		law_type = realm
	}
	feudal_tax = {
		law_type = realm
	}
	iqta_contract = {
		law_type = realm
	}
	iqta_tax = {
		law_type = realm
	}
	city_contract = {
		law_type = realm
	}
	city_tax = {
		law_type = realm
	}
	temple_contract = {
		law_type = realm
	}
	temple_tax = {
		law_type = realm
	}
	tribal_contract = {
		law_type = realm
	}
	tribal_tax = {
		law_type = realm
	}
}

laws = {

	# CENTRALIZATION LAWS
	##############################

	centralization_0 = {
		group = centralization
		# default = yes # Vanilla default

		demesne_size = -2
		vassal_limit = 10

		potential = {
			higher_tier_than = COUNT
			is_nomadic = no
		}

		allow = {
			has_law = centralization_1

			holder_scope = {
				show_scope_change = no
				NOT = { trait = uncrowned }
			}
		}

		effect = {
			log = "centralization_0 ([This.GetFullBaseName])"
			hidden_effect = {
				revoke_law = centralization_1
				revoke_law = centralization_2
				revoke_law = centralization_3
				revoke_law = centralization_4
			}
		}

		# TODO: Add nuance to law decision making
		ai_will_do = {
			factor = 0.8

			trigger = { # Need to increase vassal limit
				over_vassal_limit > 0
				over_max_demesne_size <= 0
			}
		}
	}

	centralization_1 = {
		group = centralization

		vassal_limit = 5
		demesne_size = -1

		potential = {
			higher_tier_than = COUNT
			is_nomadic = no
		}

		allow = {
			OR = {
				has_law = centralization_0
				has_law = centralization_2
			}

			trigger_if = {
				limit = { holder_scope = { is_tribal = yes } }

				OR = {
					has_law = tribal_organization_2
					has_law = tribal_organization_3
					has_law = tribal_organization_4
				}
			}
			trigger_else = {
				crownlaw_title = {
					NOT = { has_law = { crown_authority_0 } }
				}
			}

			holder_scope = {
				show_scope_change = no
				NOT = { trait = uncrowned }
			}
		}

		effect = {
			log = "centralization_1 ([This.GetFullBaseName])"
			hidden_effect = {
				revoke_law = centralization_0
				revoke_law = centralization_2
				revoke_law = centralization_3
				revoke_law = centralization_4
			}
		}

		ai_will_do = {
			factor = 0.9

			trigger = {
				trigger_if = { # Need to increase vassal limit
					limit = { has_law = centralization_2 }

					over_vassal_limit > 0
					over_max_demesne_size <= 0
				}
				trigger_else = { # Vassal limit left over
					over_vassal_limit <= 5
					over_max_demesne_size > 0
				}
			}
		}
	}

	centralization_2 = {
		group = centralization
		default = yes

		potential = {
			higher_tier_than = COUNT
			is_nomadic = no
		}

		allow = {
			OR = {
				has_law = centralization_1
				has_law = centralization_3
			}

			trigger_if = {
				limit = {
					holder_scope = { is_tribal = yes }

					OR = {
						has_law = tribal_organization_2
						has_law = tribal_organization_3
						has_law = tribal_organization_4
					}
				}
			}
			trigger_else = {
				crownlaw_title = {
					NOT = { has_law = { crown_authority_0 } }
				}
			}

			holder_scope = {
				NOT = { trait = uncrowned }
			}
		}

		effect = {
			log = "centralization_2 ([This.GetFullBaseName])"
			hidden_tooltip = {
				revoke_law = centralization_0
				revoke_law = centralization_1
				revoke_law = centralization_3
				revoke_law = centralization_4
			}
		}

		ai_will_do = {
			factor = 1

			trigger = {
				trigger_if = { # Need to increase vassal limit
					limit = { has_law = centralization_3 }

					over_vassal_limit > 0
					over_max_demesne_size <= 0
				}
				trigger_else = { # Vassal limit left over
					over_vassal_limit <= 5
					over_max_demesne_size > 0
				}
			}
		}
	}

	centralization_3 = {
		group = centralization

		demesne_size = 1
		vassal_limit = -5

		potential = {
			higher_tier_than = COUNT
			is_nomadic = no
		}

		allow = {
			OR = {
				has_law = centralization_2
				has_law = centralization_4
			}

			trigger_if = {
				limit = { holder_scope = { is_tribal = yes } }

				OR = {
					has_law = tribal_organization_2
					has_law = tribal_organization_3
					has_law = tribal_organization_4
				}
			}
			trigger_else = {
				crownlaw_title = {
					NOT = { has_law = { crown_authority_0 } }
				}
			}

			holder_scope = {
				show_scope_change = no
				NOT = { trait = uncrowned }
			}
		}

		effect = {
			log = "centralization_3 ([This.GetFullBaseName])"
			hidden_tooltip = {
				revoke_law = centralization_0
				revoke_law = centralization_1
				revoke_law = centralization_2
				revoke_law = centralization_4
			}
		}

		ai_will_do = {
			factor = 0.9

			trigger = {
				trigger_if = { # Need to increase vassal limit
					limit = { has_law = centralization_4 }

					over_vassal_limit > 0
					over_max_demesne_size <= 0
				}
				trigger_else = { # Vassal limit left over
					over_vassal_limit <= 5
					over_max_demesne_size > 0
				}
			}
		}
	}

	centralization_4 = {
		group = centralization

		vassal_limit = -10
		demesne_size = 2

		potential = {
			higher_tier_than = COUNT
			is_nomadic = no
		}

		allow = {
			has_law = centralization_3

			trigger_if = {
				limit = { holder_scope = { is_tribal = yes } }
				OR = {
					has_law = tribal_organization_2
					has_law = tribal_organization_3
					has_law = tribal_organization_4
				}
			}
			trigger_else = {
				crownlaw_title = {
					NOT = { has_law = { crown_authority_0 } }
				}
			}

			holder_scope = {
				show_scope_change = no
				NOT = { trait = uncrowned }
			}
		}

		effect = {
			log = "centralization_4 ([This.GetFullBaseName])"
			hidden_tooltip = {
				revoke_law = centralization_0
				revoke_law = centralization_1
				revoke_law = centralization_2
				revoke_law = centralization_3
			}
		}

		ai_will_do = {
			factor = 0.8

			trigger = {
				trigger_if = { # Vassal limit left over
					limit = { has_law = centralization_3 }

					over_vassal_limit <= 5
					over_max_demesne_size > 0
				}
			}
		}
	}


	# TRIBAL ORGANIZATION
	##############################

	tribal_organization_0 = {
		group = tribal_organization
		default = yes

		potential = {
			holder_scope = {
				is_tribal = yes
				higher_tier_than = COUNT
			}
		}

		allow = {
			has_law = tribal_organization_1
		}

		pass_effect = {
			log = "tribal_organization_0 pass ([This.GetFullBaseName])"
			hidden_tooltip = {
				if = {
					limit = {
						has_law = tribal_organization_1
					}
					holder_scope = {
						plus_decreased_tribal_organization_effect = yes
					}
				}
			}
		}

		effect = {
			log = "tribal_organization_0 ([This.GetFullBaseName])"
			if = {
				limit = { NOT = { has_dlc = "Conclave" } }
				set_allow_title_revokation = no
				set_allow_free_infidel_revokation = no
				set_tribal_vassal_levy_control = no
				set_tribal_vassal_tax_income = no
			}
			else_if = {
				limit = { has_dlc = "Conclave" }
				disable_council_voting_on_issue = laws
				disable_council_voting_on_issue = declare_war_interaction
				hidden_tooltip = {
					disable_council_voting_on_issue = enforce_peace
					revoke_law = law_voting_power_1
					revoke_law = war_voting_power_1
				}
			}
			hidden_tooltip = {
				revoke_law = tribal_organization_1
				revoke_law = tribal_organization_2
				revoke_law = tribal_organization_3
				revoke_law = tribal_organization_4
			}
		}

		ai_will_do = {
			factor = 0
		}
	}

	tribal_organization_1 = {
		group = tribal_organization

		unreformed_tribal_opinion = -5

		potential = {
			holder_scope = {
				is_tribal = yes
				higher_tier_than = COUNT
			}
		}

		allow = {
			holder_scope = {
				show_scope_change = no
				conditional_tooltip = {
					trigger = {
						has_game_started = yes
						tier = DUKE
					}
					prestige >= 250
				}
				conditional_tooltip = {
					trigger = {
						has_game_started = yes
						tier = KING
					}
					prestige >= 500
				}
				conditional_tooltip = {
					trigger = {
						has_game_started = yes
						tier = EMPEROR
					}
					prestige >= 1000
				}
			}
			OR = {
				has_law = tribal_organization_0
				has_law = tribal_organization_2
			}
			holder_scope = {
				show_scope_change = no
				conditional_tooltip = {
					trigger = {
						has_game_started = yes
						tier = DUKE
					}
					prestige >= 250
				}
				conditional_tooltip = {
					trigger = {
						has_game_started = yes
						tier = KING
					}
					prestige >= 500
				}
				conditional_tooltip = {
					trigger = {
						has_game_started = yes
						tier = EMPEROR
					}
					prestige >= 1000
				}
			}
		}

		pass_effect = {
			log = "tribal_organization_1 pass ([This.GetFullBaseName])"
			if = {
				limit = {
					has_game_started = yes
				}
				holder_scope = {
					show_scope_change = no
					trigger_switch = {
						on_trigger = tier
						DUKE = { prestige = -250 }
						KING = { prestige = -500 }
						EMPEROR = { prestige = -1000 }
					}
				}
			}
			hidden_tooltip = {
				if = {
					limit = {
						has_law = tribal_organization_0
					}
					holder_scope = {
						plus_increased_tribal_organization_effect = yes
					}
				}
				else_if = {
					limit = {
						has_law = tribal_organization_2
					}
					holder_scope = {
						plus_decreased_tribal_organization_effect = yes
					}
				}
			}
		}

		effect = {
			log = "tribal_organization_1 ([This.GetFullBaseName])"
			if = {
				limit = { NOT = { has_dlc = "Conclave" } }
				set_allow_title_revokation = yes
				set_allow_free_infidel_revokation = no
				set_tribal_vassal_levy_control = no
				set_tribal_vassal_tax_income = no
			}
			else_if = {
				limit = { has_dlc = "Conclave" }
				enable_council_voting_on_issue = laws
				enable_council_voting_on_issue = declare_war_interaction
				hidden_tooltip = {
					enable_council_voting_on_issue = enforce_peace
					add_law = law_voting_power_1
					add_law = war_voting_power_1
				}
			}
			hidden_tooltip = {
				revoke_law = tribal_organization_0
				revoke_law = tribal_organization_2
				revoke_law = tribal_organization_3
				revoke_law = tribal_organization_4
			}
		}

		ai_will_do = {
			factor = 0.01
			modifier = {
				factor = 2
				has_law = tribal_organization_0
			}
		}
	}

	tribal_organization_2 = {
		group = tribal_organization

		unreformed_tribal_opinion = -10

		potential = {
			holder_scope = {
				is_tribal = yes
				higher_tier_than = COUNT
			}
		}

		allow = {
			holder_scope = {
				show_scope_change = no
				trigger_if = {
					limit = {
						has_game_started = yes
					}
					conditional_tooltip = {
						trigger = { tier = DUKE }
						prestige >= 500
					}
					conditional_tooltip = {
						trigger = { tier = KING }
						prestige >= 1000
					}
					conditional_tooltip = {
						trigger = { tier = EMPEROR }
						prestige >= 2000
					}
				}
			}
			OR = {
				has_law = tribal_organization_1
				has_law = tribal_organization_3
			}
			holder_scope = {
				show_scope_change = no
				trigger_if = {
					limit = {
						has_game_started = yes
					}
					conditional_tooltip = {
						trigger = { tier = DUKE }
						prestige >= 500
					}
					conditional_tooltip = {
						trigger = { tier = KING }
						prestige >= 1000
					}
					conditional_tooltip = {
						trigger = { tier = EMPEROR }
						prestige >= 2000
					}
				}
			}
		}

		pass_effect = {
			log = "tribal_organization_2 pass ([This.GetFullBaseName])"
			if = {
				limit = {
					has_game_started = yes
				}
				holder_scope = {
					show_scope_change = no
					trigger_switch = {
						on_trigger = tier
						DUKE = { prestige = -500 }
						KING = { prestige = -1000 }
						EMPEROR = { prestige = -2000 }
					}
				}
			}
			hidden_tooltip = {
				if = {
					limit = {
						has_law = tribal_organization_1
					}
					holder_scope = {
						plus_increased_tribal_organization_effect = yes
					}
				}
				else_if = {
					limit = {
						has_law = tribal_organization_3
					}
					holder_scope = {
						plus_decreased_tribal_organization_effect = yes
					}
				}
			}
		}

		effect = {
			log = "tribal_organization_2 ([This.GetFullBaseName])"
			if = {
				limit = { NOT = { has_dlc = "Conclave" } }
				set_allow_title_revokation = yes
				set_allow_free_infidel_revokation = yes
				set_tribal_vassal_levy_control = no
				set_tribal_vassal_tax_income = no
			}
			else_if = {
				limit = { has_dlc = "Conclave" }
				enable_council_voting_on_issue = grant_landed_title_interaction
				enable_council_voting_on_issue = revoke_title_interaction
				hidden_tooltip = {
					add_law = grant_title_voting_power_1
					add_law = revoke_title_voting_power_1
				}
			}
			hidden_tooltip = {
				revoke_law = tribal_organization_0
				revoke_law = tribal_organization_1
				revoke_law = tribal_organization_3
				revoke_law = tribal_organization_4
			}
		}

		ai_will_do = {
			factor = 0.01
			modifier = {
				factor = 2
				has_law = tribal_organization_1
			}
		}
	}

	tribal_organization_3 = {
		group = tribal_organization

		unreformed_tribal_opinion = -15

		potential = {
			holder_scope = {
				is_tribal = yes
				higher_tier_than = COUNT
			}
		}

		allow = {
			holder_scope = {
				show_scope_change = no
				trigger_if = {
					limit = {
						has_game_started = yes
					}
					conditional_tooltip = {
						trigger = { tier = DUKE }
						prestige >= 750
					}
					conditional_tooltip = {
						trigger = { tier = KING }
						prestige >= 1500
					}
					conditional_tooltip = {
						trigger = { tier = EMPEROR }
						prestige >= 3000
					}
				}
			}
			OR = {
				has_law = tribal_organization_2
				has_law = tribal_organization_4
			}
			holder_scope = {
				show_scope_change = no
				trigger_if = {
					limit = {
						has_game_started = yes
					}
					conditional_tooltip = {
						trigger = { tier = DUKE }
						prestige >= 750
					}
					conditional_tooltip = {
						trigger = { tier = KING }
						prestige >= 1500
					}
					conditional_tooltip = {
						trigger = { tier = EMPEROR }
						prestige >= 3000
					}
				}
			}
		}

		pass_effect = {
			log = "tribal_organization_3 pass ([This.GetFullBaseName])"
			if = {
				limit = {
					has_game_started = yes
				}
				holder_scope = {
					show_scope_change = no
					trigger_switch = {
						on_trigger = tier
						DUKE = { prestige = -750 }
						KING = { prestige = -1500 }
						EMPEROR = { prestige = -3000 }
					}
				}
			}
			hidden_tooltip = {
				if = {
					limit = {
						has_law = tribal_organization_2
					}
					holder_scope = {
						plus_increased_tribal_organization_effect = yes
					}
				}
				else_if = {
					limit = {
						has_law = tribal_organization_4
					}
					holder_scope = {
						plus_decreased_tribal_organization_effect = yes
					}
				}
			}
		}

		effect = {
			log = "tribal_organization_3 ([This.GetFullBaseName])"
			if = {
				limit = { NOT = { has_dlc = "Conclave" } }
				set_allow_title_revokation = yes
				set_allow_free_infidel_revokation = yes
				set_tribal_vassal_levy_control = yes
				set_tribal_vassal_tax_income = yes
			}
			else_if = {
				limit = { has_dlc = "Conclave" }
				enable_council_voting_on_issue = imprison_character_interaction
				enable_council_voting_on_issue = exile_imprisoned_interaction
				enable_council_voting_on_issue = execute_imprisoned_interaction
				hidden_tooltip = {
					add_law = imprison_voting_power_1
					add_law = banish_voting_power_1
					add_law = execution_voting_power_1
				}
			}
			hidden_tooltip = {
				revoke_law = tribal_organization_0
				revoke_law = tribal_organization_1
				revoke_law = tribal_organization_2
				revoke_law = tribal_organization_4
			}
		}

		ai_will_do = {
			factor = 0.01
			modifier = {
				factor = 2
				has_law = tribal_organization_2
			}
		}
	}

	tribal_organization_4 = {
		group = tribal_organization

		unreformed_tribal_opinion = -20

		potential = {
			holder_scope = {
				is_tribal = yes
				higher_tier_than = COUNT
			}
		}

		allow = {
			has_law = tribal_organization_3
			holder_scope = {
				show_scope_change = no
				trigger_if = {
					limit = {
						has_game_started = yes
					}
					conditional_tooltip = {
						trigger = { tier = DUKE }
						prestige >= 1000
					}
					conditional_tooltip = {
						trigger = { tier = KING }
						prestige >= 2000
					}
					conditional_tooltip = {
						trigger = { tier = EMPEROR }
						prestige >= 4000
					}
				}
			}
		}

		pass_effect = {
			log = "tribal_organization_4 pass ([This.GetFullBaseName])"
			if = {
				limit = {
					has_game_started = yes
				}
				holder_scope = {
					show_scope_change = no
					trigger_switch = {
						on_trigger = tier
						DUKE = { prestige = -1000 }
						KING = { prestige = -2000 }
						EMPEROR = { prestige = -4000 }
					}
				}
			}
			hidden_tooltip = {
				if = {
					limit = {
						has_law = tribal_organization_3
					}
					holder_scope = {
						plus_increased_tribal_organization_effect = yes
					}
				}
			}
		}

		effect = {
			log = "tribal_organization_4 ([This.GetFullBaseName])"
			if = {
				limit = { NOT = { has_dlc = "Conclave" } }
				set_allow_title_revokation = yes
				set_allow_free_infidel_revokation = yes
				set_tribal_vassal_levy_control = yes
				set_tribal_vassal_tax_income = yes
			}
			else_if = {
				limit = { has_dlc = "Conclave" }
				hidden_tooltip = {
					add_law = succession_voting_power_1
					add_law = tribal_focus_0
					add_law = tribal_obligations_0
				}
			}
			custom_tooltip = {
				text = allows_change_government
			}
			hidden_tooltip = {
				revoke_law = tribal_organization_0
				revoke_law = tribal_organization_1
				revoke_law = tribal_organization_2
				revoke_law = tribal_organization_3
			}
		}

		ai_will_do = {
			factor = 0.01
			modifier = {
				factor = 2
				has_law = tribal_organization_3
			}
		}
	}
}