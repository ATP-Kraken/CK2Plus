# DO NOT ALTER THE NAME OR NUMBER OF THESE!

gender_laws = {

	agnatic_succession = {
		male_dynasty_opinion = 5
		female_dynasty_opinion = -5

		potential = {
			holder_scope = {
				trigger_if = {
					limit = { is_theocracy = yes }

					religion_allows_male_temple_holders = yes
					religion_allows_female_temple_holders = no
				}
				trigger_else = {
					NOR = {
						has_religion_feature = religion_matriarchal
						has_religion_feature = religion_equal
					}
				}
			}
		}

		allow = {
			has_law = cognatic_succession
			holder_scope = {
				show_scope_change = no

				NOT = { trait = uncrowned }

				conditional_tooltip = {
					trigger = { real_tier = COUNT }
					prestige >= 125
				}
				conditional_tooltip = {
					trigger = { real_tier = DUKE }
					prestige >= 250
				}
				conditional_tooltip = {
					trigger = { real_tier = KING }
					prestige >= 500
				}
				conditional_tooltip = {
					trigger = { real_tier = EMPEROR }
					prestige >= 1000
				}
			}
		}

		pass_effect = {
			log = "agnatic_succession pass ([This.GetFullBaseName])"
			if = {
				limit = { has_game_started = yes }
				holder_scope = {
					show_scope_change = no
					trigger_switch = {
						on_trigger = real_tier
						COUNT = { prestige = -125 }
						DUKE = { prestige = -250 }
						KING = { prestige = -500 }
						EMPEROR = { prestige = -1000 }
					}
				}
			}
		}

		effect = {
			log = "agnatic_succession ([This.GetFullBaseName])"
			if = {
				limit = { NOT = { has_dlc = "Conclave" } }

				custom_tooltip = { text = ALLOW_MATRILINEAL_MARRIAGE_OFF }
				law_set_allow_matrilineal_marriage = no
			}
			gender_succ = agnatic
		}

		default_selection = {
			factor = 1

			trigger = {
				is_law_potential = agnatic_succession

				NOR = {
					has_game_rule = {
						name = gender
						value = all
					}
					has_game_rule = {
						name = gender
						value = plus
					}
				}
			}

			mult_modifier = {
				factor = 100
				holder_scope = {
					NOR = {
						religion = west_african_pagan
						religion = west_african_pagan_reformed
						AND = {
							culture_group = tibetan_group
							NOR = {
								religion = taoist
								culture = tangut
							}
						}
					}
					primary_title = {
						NOR = {
							has_law = status_of_women_3
							has_law = status_of_women_4
						}
					}
				}
			}
		}
	}

	cognatic_succession = { # agnatic-cognatic
		female_dynasty_opinion = -2.5

		potential = {
			is_landless_type_title = no
			is_primary_type_title = no

			holder_scope = {
				is_theocracy = no

				trigger_if = {
					limit = { is_republic = yes }

					is_patrician = yes

					trigger_if = {
						limit = { independent = no }

						defacto_liege_title = {
							OR = {
								has_law = true_cognatic_succession
								has_law = cognatic_succession
							}
						}
					}
				}

				trigger_if = {
					limit = {
						NOR = {
							religion_group = muslim
							is_nomadic = yes
							has_horde_culture = yes
							has_religion_feature = religion_matriarchal
							religion = aztec
						}
					}
					always = yes
				}
				trigger_else_if = {
					limit = { has_dlc = "Conclave" }

					primary_title = {
						OR = {
							has_law = status_of_women_3
							has_law = status_of_women_4

							has_game_rule = {
								name = gender
								value = all
							}

							has_game_rule = {
								name = gender
								value = plus
							}
						}
					}
				}
			}
		}

		allow = {
			OR = {
				has_law = agnatic_succession
				has_law = cognatic_succession
			}

			holder_scope = {
				show_scope_change = no

				NOT = { trait = uncrowned }

				# Muslim/Aztec rulers have a harder time
				trigger_if = {
					limit = {
						OR = {
							religion_group = muslim
							religion = aztec
						}
					}
					trigger_if = {
						limit = { real_tier = COUNT }
						prestige >= 250
					}
					trigger_else_if = {
						limit = { real_tier = DUKE }
						prestige >= 500
					}
					trigger_else_if = {
						limit = { real_tier = KING }
						prestige >= 1000
					}
					trigger_else_if = {
						limit = { real_tier = EMPEROR }
						prestige >= 2000
					}
				}
				# Everyone Else
				trigger_else = {
					trigger_if = {
						limit = { real_tier = COUNT }
						prestige >= 125
					}
					trigger_else_if = {
						limit = { real_tier = DUKE }
						prestige >= 250
					}
					trigger_else_if = {
						limit = { real_tier = KING }
						prestige >= 500
					}
					trigger_else_if = {
						limit = { real_tier = EMPEROR }
						prestige >= 1000
					}
				}
			}
		}

		pass_effect = {
			log = "cognatic_succession pass ([This.GetFullBaseName])"

			if = {
				limit = { has_game_started = yes }

				holder_scope = {
					show_scope_change = no

					if = {
						limit = {
							OR = {
								religion_group = muslim
								religion = aztec
							}
						}

						trigger_switch = {
							on_trigger = real_tier

							COUNT = { prestige = -250 }
							DUKE = { prestige = -500 }
							KING = { prestige = -1000 }
							EMPEROR = { prestige = -2000 }
						}
					}
					else = {
						trigger_switch = {
							on_trigger = real_tier

							COUNT = { prestige = -125 }
							DUKE = { prestige = -250 }
							KING = { prestige = -500 }
							EMPEROR = { prestige = -1000 }
						}
					}
				}
			}
		}

		effect = {
			log = "cognatic_succession ([This.GetFullBaseName])"
			gender_succ = cognatic

			if = {
				limit = { NOT = { has_dlc = "Conclave" } }

				custom_tooltip = {
					text = ALLOW_MATRILINEAL_MARRIAGE_ON
					hidden_effect = { law_set_allow_matrilineal_marriage = yes }
				}
			}
		}

		default_selection = {
			factor = 10

			trigger = {
				is_law_potential = cognatic_succession
			}
		}
	}

	true_cognatic_succession = { # absolute cognatic
		potential = {
			is_landless_type_title = no

			holder_scope = {
				trigger_if = {
					limit = { is_theocracy = yes }
					religion_allows_male_temple_holders = yes
					religion_allows_female_temple_holders = yes
				}
				trigger_else_if = {
					limit = { is_republic = yes }

					is_patrician = yes

					trigger_if = {
						limit = { independent = no }

						defacto_liege_title = {
							OR = {
								has_law = true_cognatic_succession
								has_law = cognatic_succession
								has_law = enatic_cognatic_succession
							}
						}
					}
				}

				trigger_if = {
					limit = {
						OR = {
							NOR = {
								religion_group = muslim
								is_nomadic = yes
								has_horde_culture = yes
								has_religion_feature = religion_matriarchal
								has_religion_feature = religion_patriarchal
								religion = aztec
							}

							has_religion_feature = religion_equal
							# has_religion_feature = religion_feature_bon # TODO: Restore this religion_feature to prevent errors

							is_theocracy = yes # Already passed a check
						}
					}
					always = yes
				}
				trigger_else_if = {
					limit = { has_dlc = "Conclave" }

					OR = {
						primary_title = { has_law = status_of_women_4 }

						has_game_rule = {
							name = gender
							value = all
						}

						has_game_rule = {
							name = gender
							value = plus
						}
					}
				}
			}
		}

		allow = {
			OR = {
				has_law = cognatic_succession
				has_law = enatic_cognatic_succession
			}
			holder_scope = {
				show_scope_change = no

				NOT = { trait = uncrowned }

				# Muslim/Aztec rulers have a harder time
				trigger_if = {
					limit = {
						OR = {
							religion_group = muslim
							religion = aztec
						}
					}

					trigger_if = {
						limit = { real_tier = COUNT }

						prestige >= 250
					}
					trigger_else_if = {
						limit = { real_tier = DUKE }

						prestige >= 500
					}
					trigger_else_if = {
						limit = { real_tier = KING }

						prestige >= 1000
					}
					trigger_else_if = {
						limit = { real_tier = EMPEROR }

						prestige >= 2000
					}
				}

				# Everyone else
				trigger_else = {
					trigger_if = {
						limit = { real_tier = COUNT }

						prestige >= 125
					}
					trigger_else_if = {
						limit = { real_tier = DUKE }

						prestige >= 250
					}
					trigger_else_if = {
						limit = { real_tier = KING }

						prestige >= 500
					}
					trigger_else_if = {
						limit = { real_tier = EMPEROR }

						prestige >= 1000
					}
				}
			}
		}

		pass_effect = {
			log = "true_cognatic_succession pass ([This.GetFullBaseName])"
			holder_scope = {
				show_scope_change = no

				if = {
					limit = { has_game_started = yes }
					if = {
						limit = {
							OR = {
								religion_group = muslim
								religion = aztec
							}
						}

						trigger_switch = {
							on_trigger = real_tier

							COUNT = { prestige = -250 }
							DUKE = { prestige = -500 }
							KING = { prestige = -1000 }
							EMPEROR = { prestige = -2000 }
						}
					}
					else = {
						trigger_switch = {
							on_trigger = real_tier
							COUNT = { prestige = -125 }
							DUKE = { prestige = -250 }
							KING = { prestige = -500 }
							EMPEROR = { prestige = -1000 }
						}
					}
				}
			}
		}

		effect = {
			log = "true_cognatic_succession ([This.GetFullBaseName])"
			gender_succ = true_cognatic

			if = {
				limit = { NOT = { has_dlc = "Conclave" } }

				custom_tooltip = {
					text = ALLOW_MATRILINEAL_MARRIAGE_ON
					hidden_effect = { law_set_allow_matrilineal_marriage = yes }
				}
			}
		}

		default_selection = {
			factor = 1

			trigger = {
				is_law_potential = true_cognatic_succession
			}

			mult_modifier = {
				factor = 0.1
				holder_scope = {
					NOT = { has_religion_feature = religion_equal }
				}
			}

			mult_modifier = {
				factor = 100
				holder_scope = {
					has_religion_feature = religion_equal
				}
			}

			mult_modifier = {
				factor = 1000
				has_game_rule = {
					name = gender
					value = plus
				}
			}
		}
	}

	enatic_cognatic_succession = {
		male_dynasty_opinion = -2.5

		potential = {
			is_landless_type_title = no
			is_primary_type_title = no

			holder_scope = {
				is_theocracy = no

				trigger_if = {
					limit = { is_republic = yes }

					is_patrician = yes

					trigger_if = {
						limit = { independent = no }

						defacto_liege_title = {
							OR = {
								has_law = true_cognatic_succession
								has_law = enatic_cognatic_succession
							}
						}
					}
				}

				OR = {
					has_religion_feature = religion_matriarchal

					any_owned_bloodline = {
						has_bloodline_flag = bloodline_enatic_cognatic
					}
				}
			}
		}

		allow = {
			OR = {
				has_law = true_cognatic_succession
				has_law = enatic_succession
			}

			holder_scope = {
				show_scope_change = no

				NOT = { trait = uncrowned }

				# Muslim/Aztec rulers have a harder time
				trigger_if = {
					limit = {
						OR = {
							religion_group = muslim
							religion = aztec
						}
					}

					trigger_if = {
						limit = { real_tier = COUNT }

						prestige >= 250
					}
					trigger_else_if ={
						limit = { real_tier = DUKE }

						prestige >= 500
					}
					trigger_else_if = {
						limit = { real_tier = KING }

						prestige >= 1000
					}
					trigger_else_if = {
						limit = { real_tier = EMPEROR }

						prestige >= 2000
					}
				}

				# Everyone else
				trigger_else = {
					trigger_if = {
						limit = { real_tier = COUNT }

						prestige >= 125
					}
					trigger_else_if ={
						limit = { real_tier = DUKE }

						prestige >= 250
					}
					trigger_else_if = {
						limit = { real_tier = KING }

						prestige >= 500
					}
					trigger_else_if = {
						limit = { real_tier = EMPEROR }

						prestige >= 1000
					}
				}
			}
		}

		pass_effect = {
			log = "enatic_cognatic_succession pass ([This.GetFullBaseName])"
			holder_scope = {
				show_scope_change = no

				if = {
					limit = { has_game_started = yes}

					if = {
						limit = {
							OR = {
								religion_group = muslim
								religion = aztec
							}
						}

						trigger_switch = {
							on_trigger = real_tier
							COUNT = { prestige = -250 }
							DUKE = { prestige = -500 }
							KING = { prestige = -1000 }
							EMPEROR = { prestige = -2000 }
						}
					}
					else = {
						trigger_switch = {
							on_trigger = real_tier
							COUNT = { prestige = -125 }
							DUKE = { prestige = -250 }
							KING = { prestige = -500 }
							EMPEROR = { prestige = -1000 }
						}
					}
				}
			}
		}

		effect = {
			log = "enatic_cognatic_succession ([This.GetFullBaseName])"
			gender_succ = enatic_cognatic

			if = {
				limit = { NOT = { has_dlc = "Conclave" } }

				custom_tooltip = {
					text = ALLOW_MATRILINEAL_MARRIAGE_ON
					hidden_effect = { law_set_allow_matrilineal_marriage = yes }
				}
			}
		}

		default_selection = {
			factor = 100

			trigger = {
				is_law_potential = enatic_cognatic_succession
			}
		}
	}

	enatic_succession = {
		female_dynasty_opinion = 5
		male_dynasty_opinion = -5

		potential = {
			is_landless_type_title = no

			holder_scope = {
				trigger_if = {
					limit = { is_theocracy = yes }

					religion_allows_male_temple_holders = no
					religion_allows_female_temple_holders = yes
				}
				trigger_else_if = {
					limit = { is_republic = yes }

					is_patrician = yes

					trigger_if = {
						limit = { independent = no }

						defacto_liege_title = {
							OR = {
								has_law = true_cognatic_succession
								has_law = cognatic_succession
								has_law = enatic_cognatic_succession
							}
						}
					}
				}

				OR = {
					is_theocracy = yes
					has_religion_feature = religion_matriarchal
				}
			}
		}

		allow = {
			has_law = enatic_cognatic_succession

			holder_scope = {
				show_scope_change = no

				NOT = { trait = uncrowned }

				# Muslim/Aztec rulers have a harder time
				trigger_if = {
					limit = {
						OR = {
							religion_group = muslim
							religion = aztec
						}
					}

					trigger_if = {
						limit = { real_tier = COUNT }

						prestige >= 250
					}
					trigger_else_if ={
						limit = { real_tier = DUKE }

						prestige >= 500
					}
					trigger_else_if = {
						limit = { real_tier = KING }

						prestige >= 1000
					}
					trigger_else_if = {
						limit = { real_tier = EMPEROR }

						prestige >= 2000
					}
				}

				# Everyone else
				trigger_else = {
					trigger_if = {
						limit = { real_tier = COUNT }

						prestige >= 125
					}
					trigger_else_if ={
						limit = { real_tier = DUKE }

						prestige >= 250
					}
					trigger_else_if = {
						limit = { real_tier = KING }

						prestige >= 500
					}
					trigger_else_if = {
						limit = { real_tier = EMPEROR }

						prestige >= 1000
					}
				}
			}
		}

		pass_effect = {
			log = "enatic_succession pass ([This.GetFullBaseName])"
			holder_scope = {
				show_scope_change = no
				if = {
					limit = { has_game_started = yes }
					if = {
						limit = {
							OR = {
								religion_group = muslim
								religion = aztec
							}
						}
						trigger_switch = {
							on_trigger = real_tier
							COUNT = { prestige = -250 }
							DUKE = { prestige = -500 }
							KING = { prestige = -1000 }
							EMPEROR = { prestige = -2000 }
						}
					}
					else = {
						trigger_switch = {
							on_trigger = real_tier
							COUNT = { prestige = -125 }
							DUKE = { prestige = -250 }
							KING = { prestige = -500 }
							EMPEROR = { prestige = -1000 }
						}
					}
				}
			}
		}

		effect = {
			log = "enatic_succession ([This.GetFullBaseName])"
			gender_succ = enatic

			if = {
				limit = { NOT = { has_dlc = "Conclave" } }

				custom_tooltip = { text = ALLOW_MATRILINEAL_MARRIAGE_ON }
				law_set_allow_matrilineal_marriage = yes
			}
		}
	}
}
